define ("mod_debate/debate_view",["jquery","core/ajax","core/str","core/config","core/notification","core/templates"],function(a,b,c,d,e,f){var g={init:function init(c,d,h,i,j,k,l,m){var n=0,o="",p="",q=0,r="",s="",t="",u="",v=function(){var a=0;return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}();a.animateToDiv=function(){a("html, body").animate({scrollTop:a(".mod-debate-topic-container").offset().top},2e3)};a(".mod-debate-response-input").keyup(function(){v(function(){a("div").remove(".mod-debate-find-response");var c=a(p).val();if(0<c.length){var d=b.call([{methodname:"mod_debate_find_debate_respose",args:{courseid:parseInt(i),debateid:parseInt(j),response:c,responsetype:parseInt(n)}}]);d[0].done(function(b){if(b.result){var c=JSON.parse(b.data);if(a("#mod-debate-insert-postive-response").is(":visible")||a("#mod-debate-insert-negative-response").is(":visible")){f.render("mod_debate/debate_find_response",{found_response:c}).then(function(b){var c=a(o);c.after(b)}).fail(e.exception)}}}).fail(e.exception)}},700)});a(document).on("click",".mod-debate-negative-delete",function(){q=a(this).attr("data-id");g.deleteResponse(i,j,q)});a(document).on("click",".mod-debate-positive-delete",function(){q=a(this).attr("data-id");g.deleteResponse(i,j,q)});a(document).on("click",".mod-debate-negative-edit",function(){q=a(this).attr("data-id");r="#element"+q;s="#element"+q+"container";if(a("#mod-debate-insert-postive-response").is(":hidden")&&a("#mod-debate-insert-negative-response").is(":hidden")){var b=a(r).text().trim();n=0;o="#mod-debate-insert-negative-response";p="#mod-debate-negative-response-input";t="mod-debate-negative-edit";u="mod-debate-negative-delete";a(p).val(b);a(p).html(b);a(s).css("display","none");a(o).css("display","block");a.animateToDiv()}else{g.renderNotification(0,"info")}});a(document).on("click",".mod-debate-positive-edit",function(){q=a(this).attr("data-id");r="#element"+q;s="#element"+q+"container";if(a("#mod-debate-insert-negative-response").is(":hidden")&&a("#mod-debate-insert-postive-response").is(":hidden")){var b=a(r).text().trim();n=1;o="#mod-debate-insert-postive-response";p="#mod-debate-positive-response-input";t="mod-debate-positive-edit";u="mod-debate-positive-delete";a(p).val(b);a(p).html(b);a(s).css("display","none");a(o).css("display","block");a.animateToDiv()}else{g.renderNotification(0,"info")}});a(document).on("click",".mod-debate-positive-icon",function(){if(a("#mod-debate-insert-negative-response").is(":hidden")&&a("#mod-debate-insert-postive-response").is(":hidden")){var c=b.call([{methodname:"mod_debate_check_response_allocation",args:{debateid:parseInt(j),attribute:"positive",userid:parseInt(h)}}]);c[0].done(function(b){var c=b.result;if(c){n=1;o="#mod-debate-insert-postive-response";p="#mod-debate-positive-response-input";t="mod-debate-positive-edit";u="mod-debate-positive-delete";a(p).val("");a(o).css("display","block");q=0}else{e.addNotification({message:b.message,type:"info"})}}).fail(e.exception)}else{g.renderNotification(0,"info")}});a(document).on("click",".mod-debate-negative-icon",function(){if(a("#mod-debate-insert-postive-response").is(":hidden")&&a("#mod-debate-insert-negative-response").is(":hidden")){var c=b.call([{methodname:"mod_debate_check_response_allocation",args:{debateid:parseInt(j),attribute:"negative",userid:parseInt(h)}}]);c[0].done(function(b){var c=b.result;if(c){n=0;o="#mod-debate-insert-negative-response";p="#mod-debate-negative-response-input";t="mod-debate-negative-edit";u="mod-debate-negative-delete";a(p).val("");a(o).css("display","block");q=0}else{e.addNotification({message:b.message,type:"info"})}}).fail(e.exception)}else{g.renderNotification(0,"info")}});a(document).on("click","#mod-debate-cancel-respose",function(){a(o).css("display","none");a(s).css("display","block");a("div").remove(".mod-debate-find-response")});a(document).on("click","#mod-debate-update-response",function(){a("div").remove(".mod-debate-find-response");var h=a(p).val();if(0<h.length){var v=b.call([{methodname:"mod_debate_add_debate_respose",args:{courseid:parseInt(i),debateid:parseInt(j),response:h,responsetype:parseInt(n),id:parseInt(q)}}]);v[0].done(function(b){if(b.result){a(o).css("display","none");a("div").remove(".mod-debate-find-response");a(s).remove();if(0===q&&a.isNumeric(b.id)){q=b.id}var i={user_profile_image:d,user_full_name:c,response:h,elementidcontainer:"element"+q+"container",elementid:"element"+q,user_capability:k,user_edit_capability:l,user_delete_capability:m,id:q,editid:t,deleteid:u};f.render("mod_debate/debate_response_output",i).then(function(b){var c=a(o);c.after(b);q=0;a("div").remove(".mod-debate-find-response");s="";r=""}).fail(e.exception)}else{g.renderNotification(2,"error")}a("div").remove(".mod-debate-find-response")}).fail(e.exception)}else{g.renderNotification(1,"info")}})},deleteResponse:function deleteResponse(d,f,h){c.get_strings([{key:"confirm_delete",component:"mod_debate"}]).done(function(c){if(confirm(c[0])){var i=b.call([{methodname:"mod_debate_delete_debate_respose",args:{courseid:parseInt(d),debateid:parseInt(f),id:parseInt(h)}}]);i[0].done(function(b){if(b.result){a("#element"+h+"container").remove();g.renderNotification(4,"info")}else{g.renderNotification(3,"info")}}).fail(e.exception)}})},renderNotification:function renderNotification(a,b){c.get_strings([{key:"edit_mode_active",component:"mod_debate"},{key:"empty_response",component:"mod_debate"},{key:"error_add",component:"mod_debate"},{key:"error_delete",component:"mod_debate"},{key:"success_delete",component:"mod_debate"}]).then(function(c){e.addNotification({message:c[a],type:b})})}};return g});
//# sourceMappingURL=debate_view.min.js.map
