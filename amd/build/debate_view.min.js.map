{"version":3,"sources":["../src/debate_view.js"],"names":["define","$","AJAX","str","mdlcfg","notification","templates","init","userFullName","userImageURL","userID","courseID","debateID","cmID","responseAllowed","positiveResponse","negativeResponse","responseType","responseId","responseTextID","delay","timer","callback","ms","clearTimeout","setTimeout","getAllocation","attr","result","keyup","remove","userResponsetext","val","length","responseAjax","call","methodname","args","courseid","debateid","cmid","response","responsetype","done","found","getResponses","JSON","parse","data","render","found_response","then","html","debateResponse","after","fail","exception","document","on","is","css","userResponse","responseCall","user_profile_image","user_full_name","outputResponse"],"mappings":"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","sourcesContent":["/**\n * js for debate page.\n *\n * @package     mod_debate\n * @copyright   2020 Safat Shahin <safatshahin@gmail.com>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/str', 'core/config', 'core/notification', 'core/templates'],\n    function($, AJAX, str,\n             mdlcfg, notification, templates) {\n        var debateView = {\n            init: function(userFullName, userImageURL, userID, courseID, debateID, cmID,\n                           responseAllowed, positiveResponse, negativeResponse) {\n                var responseType = 0;\n                var responseId = '';\n                var responseTextID = '';\n                var delay = (function() {\n                    var timer = 0;\n                    return function(callback, ms) {\n                        clearTimeout(timer);\n                        timer = setTimeout(callback, ms);\n                    };\n                })();\n                $.getAllocation = function(attr) {\n                    var result = true;\n                    switch (responseAllowed) {\n                        case '0':\n                            // UNLIMITED RESPONSE\n                            break;\n                        case '1':\n                            // ONE RESPONSE IN ANY ONE SIDE\n                            if (positiveResponse > 0 || negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                        case '2':\n                            // ONE RESPONSE IN EACH SIDE\n                            if (positiveResponse > 0 && negativeResponse > 0) {\n                                result = false;\n                            } else if (attr === 'positive' && positiveResponse > 0) {\n                                result = false;\n                            } else if (attr === 'negative' && negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                    }\n                    return result;\n                };\n                $(\".mod-debate-response-input\").keyup(function() {\n                    delay(function() {\n                        $(\"div\").remove(\".mod-debate-find-response\");\n                        var userResponsetext = $(responseTextID).val();\n                        if (userResponsetext.length > 0) {\n                            var responseAjax = AJAX.call([{\n                                methodname: 'mod_debate_find_debate_respose',\n                                args: {\n                                    courseid: courseID,\n                                    debateid: debateID,\n                                    cmid: cmID,\n                                    response: userResponsetext,\n                                    responsetype: responseType\n                                }\n                            }]);\n                            responseAjax[0].done(function(found) {\n                                if (found.result) {\n                                    var getResponses = JSON.parse(found.data);\n                                    var context = {\n                                        found_response: getResponses\n                                    };\n                                    templates.render('mod_debate/debate_find_response', context).then(function(html, js) {\n                                        var debateResponse = $(responseId);\n                                        debateResponse.after(html);\n                                    }).fail(notification.exception);\n                                }\n                            }).fail(notification.exception);\n                        }\n                    }, 700);\n                });\n                $(document).on('click', '.mod-debate-positive-icon', function() {\n                    var result = $.getAllocation('positive');\n                    if (result && $('#mod-debate-insert-negative-response').is(\":hidden\")) {\n                        responseType = 1;\n                        responseId = '#mod-debate-insert-postive-response';\n                        responseTextID = '#mod-debate-positive-response-input';\n                        $(responseTextID).val('');\n                        $(responseId).css('display', 'block');\n                    }\n                });\n                $(document).on('click', '.mod-debate-negative-icon', function() {\n                    var result = $.getAllocation('negative');\n                    if (result && $('#mod-debate-insert-postive-response').is(\":hidden\")) {\n                        responseType = 0;\n                        responseId = '#mod-debate-insert-negative-response';\n                        responseTextID = '#mod-debate-negative-response-input';\n                        $(responseTextID).val('');\n                        $(responseId).css('display', 'block');\n                    }\n                });\n                $(document).on('click', '#mod-debate-cancel-respose', function() {\n                    $(responseId).css('display', 'none');\n                    $(\"div\").remove(\".mod-debate-find-response\");\n                });\n                $(document).on('click', '#mod-debate-update-response', function() {\n                    $(\"div\").remove(\".mod-debate-find-response\");\n                    var userResponse = $(responseTextID).val();\n                    if(userResponse.length > 0) {\n                        var responseCall = AJAX.call([{\n                            methodname: 'mod_debate_add_debate_respose',\n                            args: {\n                                courseid: courseID,\n                                debateid: debateID,\n                                cmid: cmID,\n                                response: userResponse,\n                                responsetype: responseType\n                            }\n                        }]);\n                        responseCall[0].done(function(result) {\n                            if (result) {\n                                if (responseType === 0) {\n                                    negativeResponse++;\n                                } else {\n                                    positiveResponse++;\n                                }\n                                $(responseId).css('display', 'none');\n                                $(\"div\").remove(\".mod-debate-find-response\");\n                                var outputContext = {\n                                    user_profile_image: userImageURL,\n                                    user_full_name: userFullName,\n                                    response: userResponse\n                                };\n                                templates.render('mod_debate/debate_response_output', outputContext).then(function (html, js) {\n                                    var outputResponse = $(responseId);\n                                    outputResponse.after(html);\n                                }).fail(notification.exception);\n                            } else {\n                                //error checking\n                            }\n                        }).fail(notification.exception);\n                    }\n                });\n            }\n        };\n        return debateView;\n    });\n"],"file":"debate_view.min.js"}